<section class="main-container">
  <div class="flex-title">
    <h2 translate>Books List</h2>
    <div>
      @if (isAdmin()) {
        <button
          class=""
          (click)="goToAddBook()"
          type="submit"
          translate
          name="createBook"
        >
          {{ "Create Book" }}
        </button>
      }
    </div>
  </div>
  <!-- style="display: flex; justify-content: space-between" -->

  <div>
    <div class="toolbar">
      <mat-form-field class="name-form">
        <mat-icon matPrefix>search</mat-icon>
        <input
          (input)="data.queryBy({ name: $event.value })"
          matInput
          placeholder="Search"
        />
      </mat-form-field>
      <mat-form-field class="created-at-form">
        <input
          (dateChange)="data.queryBy({ createdAt: $event.value })"
          matInput
          [matDatepicker]="picker"
          placeholder="Created At"
        />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
      <mat-form-field class="property-form" disabled>
        <mat-label>Order by</mat-label>
        <mat-select
          disabled
          value="createdAt"
          (selectionChange)="data.sortBy({ property: $event.value })"
        >
          <mat-option value="name">name</mat-option>
          <mat-option value="createdAt">createdAt</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-button-toggle-group
        value="desc"
        (change)="data.sortBy({ order: $event.value })"
        disabled
      >
        <mat-button-toggle value="asc"
          ><mat-icon>arrow_upward</mat-icon></mat-button-toggle
        >
        <mat-button-toggle value="desc"
          ><mat-icon>arrow_downward</mat-icon></mat-button-toggle
        >
      </mat-button-toggle-group>
    </div>

    <app-customized-table [data]="data">
      <ng-container matColumnDef="image">
        <th mat-header-cell *matHeaderCellDef>Imagem</th>
        <td mat-cell *matCellDef="let book">
          <img [src]="book.image" alt="{{ book.name }}" />
        </td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef translate>Name</th>
        <td mat-cell *matCellDef="let book">{{ book.name }}</td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Preço</th>
        <td mat-cell *matCellDef="let book">{{ book.price }}</td>
      </ng-container>

      <ng-container matColumnDef="availability">
        <th mat-header-cell *matHeaderCellDef>Disponibilidade</th>
        <td mat-cell *matCellDef="let book">
          {{ bookAvailabilityRatio(book) }}
        </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Ações</th>
        <td mat-cell *matCellDef="let book">
          <div style="display: flex; justify-content: space-evenly">
            <button
              name="rentBook"
              [disabled]="!isBookAvailable(book)"
              (click)="openRentBookDialog(book)"
            >
              emprestar
            </button>
            @if (isAdmin()) {
              <button (click)="addBookItem(book)" name="addBook">
                adicionar
              </button>
              <button (click)="removeBookItem(book)" name="removeBook">
                remover
              </button>
              <button disabled name="deleteBook">deletar</button>
            }
          </div>
        </td>
      </ng-container>
    </app-customized-table>
  </div>
</section>

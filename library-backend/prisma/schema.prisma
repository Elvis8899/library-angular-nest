generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRoleEnum {
  admin
  client
}

model User {
  id       String       @unique
  name     String
  email    String       @unique
  password String
  cpf      String?
  role     UserRoleEnum

  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  bookRentalDetails BookRentalDetails[]
}

model BookInfo {
  id    String @unique
  name  String
  image String
  price Int

  bookItems BookItem[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum BookItemStatus {
  rented
  available
}

model BookItem {
  id     String         @unique
  status BookItemStatus @default(available)

  bookId     String
  book       BookInfo            @relation(fields: [bookId], references: [id], onDelete: Cascade)
  bookRental BookRentalDetails[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum RentalStatus {
  rented
  finished
}

model BookRentalDetails {
  id           String       @unique
  rentalStatus RentalStatus

  bookItemId String
  bookItem   BookItem @relation(fields: [bookItemId], references: [id], onDelete: Cascade)
  userId     String
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  overdueDate  DateTime
  deliveryDate DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
